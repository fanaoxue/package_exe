(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f9d55e78"],{3846:function(n,o,t){t("9e1e")&&"g"!=/./g.flags&&t("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:t("0bfb")})},"4cab":function(n,o,t){},"6b54":function(n,o,t){"use strict";t("3846");var i=t("cb7c"),a=t("0bfb"),e=t("9e1e"),s="toString",l=/./[s],c=function(n){t("2aba")(RegExp.prototype,s,n,!0)};t("79e5")((function(){return"/a/b"!=l.call({source:"a",flags:"b"})}))?c((function(){var n=i(this);return"/".concat(n.source,"/","flags"in n?n.flags:!e&&n instanceof RegExp?a.call(n):void 0)})):l.name!=s&&c((function(){return l.call(this)}))},a699:function(n,o,t){"use strict";var i=t("4cab"),a=t.n(i);a.a},c3db:function(n,o,t){"use strict";t.r(o);var i=function(){var n=this,o=n.$createElement,t=n._self._c||o;return t("div",{staticClass:"upload_pound_bill_multiple_diff_box"},[t("v-header",{attrs:{title:"上传磅单",backFn:n.backHandle}}),t("div",{staticClass:"warpper"},[t("example-picture",{staticClass:"mt5",attrs:{tip3:!0}}),"0"===n.activeType?t("div",{staticClass:"container"},[t("p",{staticClass:"upload_label"},[n._v("请上传装货磅单：")]),t("div",{staticClass:"upload_wrapper",class:{upload_item_no:!n.loadingInfo.tonnageUrl.length}},[t("single-upload",{directives:[{name:"show",rawName:"v-show",value:"0"===n.activeType,expression:"activeType === '0'"}],attrs:{urlArr:n.loadingInfo.tonnageUrl,type:"0",canModifyPhoto:"1",maxLen:10},on:{change:n.handleUpload,remove:n.removeImg}})],1)]):n._e(),"1"===n.activeType?t("div",{staticClass:"container"},[t("p",{staticClass:"upload_label"},[n._v("请上传卸货磅单：")]),t("div",{staticClass:"upload_wrapper",class:{upload_item_no:!n.unLoadingInfo.tonnageUrl.length}},[t("single-upload",{directives:[{name:"show",rawName:"v-show",value:"1"===n.activeType,expression:"activeType === '1'"}],attrs:{urlArr:n.unLoadingInfo.tonnageUrl,type:"1",canModifyPhoto:"1",maxLen:10},on:{change:n.handleUpload,remove:n.removeImg}})],1)]):n._e(),t("van-cell-group",{staticClass:"input_group mt5"},[t("van-field",{directives:[{name:"show",rawName:"v-show",value:"0"===n.activeType,expression:"activeType === '0'"}],attrs:{label:"装货总数量",placeholder:"请输入装货总数量","input-align":"right",type:"number",readonly:""},on:{click:function(o){return n.showConfirm("0")}},scopedSlots:n._u([{key:"button",fn:function(){return[t("p",{staticClass:"input_right"},[n._v(n._s(n.resultInfo.goodsAmountType))])]},proxy:!0}]),model:{value:n.loadingInfo.tonnage,callback:function(o){n.$set(n.loadingInfo,"tonnage",o)},expression:"loadingInfo.tonnage"}}),t("van-field",{directives:[{name:"show",rawName:"v-show",value:"1"===n.activeType,expression:"activeType === '1'"}],attrs:{label:"卸货总数量",placeholder:"请输入卸货总数量","input-align":"right",type:"number",readonly:""},on:{click:function(o){return n.showConfirm("1")}},scopedSlots:n._u([{key:"button",fn:function(){return[t("p",{staticClass:"input_right"},[n._v(n._s(n.resultInfo.goodsAmountType))])]},proxy:!0}]),model:{value:n.unLoadingInfo.tonnage,callback:function(o){n.$set(n.unLoadingInfo,"tonnage",o)},expression:"unLoadingInfo.tonnage"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:n.noticeLoadingShow&&"0"===n.activeType,expression:"noticeLoadingShow && activeType === '0'"}],staticClass:"send_notice"},[t("van-icon",{attrs:{name:"warning",size:"14"}}),t("p",{staticClass:"notice_text"},[n._v("已上传装货磅单，点击下方按钮上传卸货磅单")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:n.noticeUnLoadingShow&&"1"===n.activeType,expression:"noticeUnLoadingShow && activeType === '1'"}],staticClass:"send_notice"},[t("van-icon",{attrs:{name:"warning",size:"14"}}),t("p",{staticClass:"notice_text"},[n._v("若您还没有卸货磅单，可选择【暂不上传】")])],1)],1),t("div",{staticClass:"btn_container"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"0"===n.activeType,expression:"activeType === '0'"}],staticClass:"send_btn"},[t("van-button",{attrs:{round:"",type:"primary"},on:{click:n.sendLoading}},[n._v("确认提交，下一步")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"===n.activeType,expression:"activeType === '1'"}],staticClass:"send_btn_group"},[t("p",{staticClass:"send_btn"},[t("van-button",{attrs:{round:"",type:"primary"},on:{click:n.sendUnloading}},[n._v("确认提交")])],1),t("p",{staticClass:"send_btn"},[t("van-button",{attrs:{round:"",type:"primary",color:"#ccc"},on:{click:n.noSendUnLoading}},[n._v("暂不上传")])],1)])]),t("modify-amount-popup",{attrs:{modifyAmountPopop:n.modifyAmountPopop,confirmObj:n.modifyAmountInfo},on:{change:n.onPopupConfirm}})],1)},a=[],e=(t("6b54"),t("22b6")),s=t("77ea"),l=t("2f14"),c=t("a711"),r=t("4e2c"),d=t("1745"),g={components:{ExamplePicture:c["a"],SingleUpload:d["a"],ModifyAmountPopup:r["a"]},props:{},name:"upload_pound_bill_multiple_diff",data:function(){return{fromType:this.$route.query.from_type||"",taxWaybillId:this.$route.query.tax_waybill_id,activeType:this.$route.query.active_type||"0",uploadType:"",noticeLoadingShow:!1,noticeUnLoadingShow:!1,modifyAmountPopop:!1,modifyAmountInfo:{modifyType:"",modifyAmountType:"",modifyAmountNum:""},loadingInfo:{tonnage:"",tonnageUrl:[],originalTonnage:"",originalTonnageUrl:""},unLoadingInfo:{tonnage:"",tonnageUrl:[],originalTonnage:"",originalTonnageUrl:""},resultInfo:{},btnSending:!1,locationInfo:{},locationFailInfo:{}}},watch:{},computed:{},methods:{backHandle:function(){if("1"===this.activeType)return this.init(),void(this.activeType="0");this.$router.back()},showConfirm:function(n){this.modifyAmountInfo={modifyType:n,modifyAmountType:this.resultInfo.goodsAmountType||"",modifyAmountNum:"0"===n?this.loadingInfo.tonnage:this.unLoadingInfo.tonnage},this.modifyAmountPopop=!0},onPopupConfirm:function(n){this.modifyAmountPopop=!1,n.cancelBtn||("0"===this.modifyAmountInfo.modifyType?this.loadingInfo=Object.assign(this.loadingInfo,{tonnage:n.value}):this.unLoadingInfo=Object.assign(this.unLoadingInfo,{tonnage:n.value}))},removeImg:function(n,o){"0"!==n?"1"===n&&this.unLoadingInfo.tonnageUrl.splice(o,1):this.loadingInfo.tonnageUrl.splice(o,1)},handleUpload:function(n){var o;"0"!==this.resultInfo.canModifyPhoto&&(this.uploadType=n,o="0"===n?10-this.loadingInfo.tonnageUrl.length:10-this.unLoadingInfo.tonnageUrl.length,Object(s["i"])({cameraType:"7",num:o,fileType:"1",triggerType:"2",buriedPointType:"34",logExplain:"大宗多趟区分上传磅单"}))},receviveImgJson:function(n){if(n){var o=JSON.parse(n),t=o.imgData;"0"!==this.uploadType?"1"===this.uploadType&&(this.unLoadingInfo=Object.assign(this.unLoadingInfo,{tonnageUrl:this.unLoadingInfo.tonnageUrl.concat(t)})):this.loadingInfo=Object.assign(this.loadingInfo,{tonnageUrl:this.loadingInfo.tonnageUrl.concat(t)})}},locationFail:function(n){n&&(this.locationFailInfo=JSON.parse(decodeURI(n)))},backAppNewLocation:function(n){n&&"{}"!==n&&(this.locationInfo=JSON.parse(decodeURI(n)))},sendLoading:function(){this.loadingInfo.tonnageUrl.length?this.sureAction(0):this.$toast("请上传装货磅单")},sendUnloading:function(){this.unLoadingInfo.tonnageUrl.length?this.sureAction(1):this.$toast("请上传卸货磅单")},sureAction:function(n){var o=this;if(!this.btnSending&&this.resultInfo.canFinishOrder){var t={reInfo:"H5没收到客户端定位信息",locationTime:(new Date).getTime()};"{}"!==JSON.stringify(this.locationInfo)?t=this.locationInfo:"{}"!==JSON.stringify(this.locationFailInfo)&&(t=this.locationFailInfo);var i="1";this.unLoadingInfo.tonnageUrl.toString()===this.unLoadingInfo.originalTonnageUrl.toString()&&this.loadingInfo.tonnageUrl.toString()===this.loadingInfo.originalTonnageUrl.toString()&&(i="0");var a="1";this.unLoadingInfo.tonnage===this.unLoadingInfo.originalTonnage&&this.loadingInfo.tonnage===this.loadingInfo.originalTonnage&&(a="0"),this.$toast.loading({message:"正在提交"}),this.btnSending=!0,Object(e["a"])({sid:"925033",data:{taxWaybillId:this.taxWaybillId,receiptUrls:1===n?this.unLoadingInfo.tonnageUrl:this.loadingInfo.tonnageUrl,pictureType:1===n?"0":"1",locationInfo:t,tonnage:1===n?this.unLoadingInfo.tonnage:this.loadingInfo.tonnage,canModTonnage:a,isModifyPhoto:i,canFinishOrder:this.resultInfo.canFinishOrder},encrypt:"0"}).then((function(t){if("0"===t.data.reCode){if(o.$toast("上传成功"),0===n)return o.init("1"),void(o.btnSending=!1);"1"===t.data.result.isFreshClient&&Object(s["r"])(),Object(l["h"])("/pound_success?tax_waybill_id=".concat(o.taxWaybillId,"&from_diff=1&from_type=").concat(o.fromType),o),setTimeout((function(){o.btnSending=!1}),200)}else o.btnSending=!1})).catch((function(){o.btnSending=!1}))}},noSendUnLoading:function(){this.$router.push("/pound_success?tax_waybill_id=".concat(this.taxWaybillId,"&from_diff=1&from_type=").concat(this.fromType))},init:function(n){var o=this;this.$toast.loading({message:"加载中"}),Object(e["a"])({sid:"925031",data:{loadType:"1",taxWaybillId:this.taxWaybillId},encrypt:"0"}).then((function(t){if("0"===t.data.reCode){var i=t.data.result;o.resultInfo=i;var a=i.ckd||[];o.loadingInfo={tonnage:i.loadingTonnage,tonnageUrl:a,originalTonnage:i.loadingTonnage,originalTonnageUrl:a.concat()},i.ckd&&i.ckd.length&&(o.noticeLoadingShow=!0);var e=i.hd||[];o.unLoadingInfo={tonnage:i.unloadingTonnage,tonnageUrl:e,originalTonnage:i.unloadingTonnage,originalTonnageUrl:e.concat()},i.hd&&i.hd.length&&(o.noticeUnLoadingShow=!0),"1"===n&&(o.activeType="1")}else o.resultInfo={}}))}},created:function(){this.init(),Object(s["h"])({tip:"您的定位服务未开启，请前往开启"}),window.AppJSApi_BackAppPhotoJson=this.receviveImgJson,window.AppJSApi_BackAppNewLocation=this.backAppNewLocation,window.AppJSApi_BackLocationFailed=this.locationFail,window.AppJSApi_InitSendFlag=this.locationFail},mounted:function(){}},u=g,p=(t("a699"),t("2877")),f=Object(p["a"])(u,i,a,!1,null,"7b5d7446",null);o["default"]=f.exports}}]);