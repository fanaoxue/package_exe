webpackJsonp([74],{"3yY/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("4qDb");var i=a("iRBI"),s=a("IHPB"),n=a.n(s),o=a("rVsN"),l=a.n(o),c=(a("Jg3o"),a("ziXK")),d=(a("LJCJ"),a("OeHp")),r=(a("gja/"),a("O8Zg")),v=(a("y8TG"),a("Xm+1")),u=(a("7ZMB"),a("k/cs")),f=a("KS8L"),h=a("0Dnf"),p=a("3KrX"),_=a("P9l9"),m=(u.a,v.a,r.a,d.a,c.a,{name:"delivery_goods",data:function(){return{page:!1,isLoading:!1,cardShow:!1,loading:!1,finished:!1,finishedText:"",actions:[{name:"修改",value:"modify"},{name:"删除",value:"delete"}],pageIdx:1,cardList:[],transportTemplateId:""}},components:{vanNavBar:u.a,vanButton:v.a,vanList:r.a,vanPullRefresh:d.a,vanActionSheet:c.a},beforeRouteEnter:function(t,e,a){a(function(t){"modify_template"==e.name&&(t.cardShow=!1)})},mounted:function(){window.AppJSApi_finishCallBack=this.onRefresh,this.$store.commit("updateLoadingStatus",{isLoading:!1}),this.dataInit(this.pageIdx)},methods:{onClickLeft:function(){Object(f.a)(-1)},_getBaseInfo:function(){var t=this;return new l.a(function(e,a){t.$store.commit("updateLoadingStatus",{isLoading:!0}),Object(_.n)({}).then(function(i){t.$store.commit("updateLoadingStatus",{isLoading:!1}),0==i.data.reCode?e(i.data.result):(t.$vux.toast.text(i.data.reInfo,"middle"),a())}).catch(function(e){t.$vux.toast.text(e.message,"middle"),a()})})},dataInit:function(){var t=this;this._getBaseInfo().then(function(e){t.finished=!1,t.pageIdx="1",t._getDeliveryGoodsTemplete().then(function(e){t.page=!0}).catch(function(e){t.page=!0})})},_getDeliveryGoodsTemplete:function(){var t=this;return new l.a(function(e,a){t.finishedText="没有更多了~~",t.$store.commit("updateLoadingStatus",{isLoading:!0}),Object(p.c)({pageIdx:t.pageIdx}).then(function(i){if(t.$store.commit("updateLoadingStatus",{isLoading:!1}),t.isLoading=!1,"0"===i.data.reCode){var s;if("1"==t.pageIdx)t.cardList=i.data.result.list;else(s=t.cardList).push.apply(s,n()(i.data.result.list));Number(i.data.result.list.length)<15&&(t.finished=!0),e()}else t.$vux.toast.text(i.data.reInfo,"middle"),a()}).catch(function(){t.$vux.toast.text(err.message,"middle"),a()})})},onRefresh:function(){this.pageIdx="1",this.finished=!1,this._getDeliveryGoodsTemplete()},onLoad:function(){var t=this;setTimeout(function(){t.pageIdx=Number(t.pageIdx)+1,t._getDeliveryGoodsTemplete(t.pageIdx).then(function(t){}).catch(function(t){Object(i.a)(t.message)}),t.loading=!1},1e3)},buildDeliveryGoods:function(){var t=Object(f.v)();if(console.log("=========="+t),0===t)this.$router.push({path:"/delivery_goods_first",pageType:"0"});else{var e=h.a.APP_URL+"/delivery_goods_first?pageType=0";Object(f.n)({url:e})}},useBtnClick:function(t){if(0===Object(f.v)())this.$router.push({path:"/delivery_goods_first",query:{transportTemplateId:t,pageType:"1"}});else{var e=h.a.APP_URL+"/delivery_goods_first?transportTemplateId="+t+"&pageType=1";Object(f.n)({url:e})}},chooseItem:function(t){this.transportTemplateId=t.transportTemplateId,this.cardShow=!0},onSelect:function(t){var e=this;this.cardShow=!1,"delete"===t.value?this.$klb.confirm.show({title:"提示",confirmText:"确定",cancelText:"取消",content:"是否确认删除？",onConfirm:function(){deleteTemplate({transportTemplateId:e.transportTemplateId,source:"2"}).then(function(t){Object(i.a)(t.data.reInfo),e.dataInit("1",e.templateType)}).catch(function(){})},onCancel:function(){},onClose:function(){}}):this.$router.push({path:"/modify_template",query:{transportTemplateId:this.transportTemplateId}})}}}),g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"delivery_goods"},[a("c-header",{staticClass:"header",attrs:{isShowTitle:""}},[a("van-nav-bar",{attrs:{title:"发货","left-arrow":"",fixed:""},on:{"click-left":t.onClickLeft}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.page,expression:"page"}],staticClass:"sub_page_base"},[a("div",{staticClass:"content"},[a("van-button",{staticClass:"btn"},[t._v("常用发货模板")]),t._v(" "),a("van-button",{attrs:{type:"default"},on:{click:t.buildDeliveryGoods}},[t._v("新建货源")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.cardList.length,expression:"cardList.length === 0"}],staticClass:"default_tips"},[t._m(0),t._v(" "),a("div",{staticClass:"p2"},[t._v("\n        您可以在发货完成后保存为常用模板，便于后期直接使用模板发货，无需再次填写相关固定信息。\n      ")]),t._v(" "),a("div",{staticClass:"p3"},[t._v("当前无常用模板，请点击上方【新建货源】。")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0!==t.cardList.length,expression:"cardList.length !== 0"}],staticClass:"list"},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":t.finishedText,"immediate-check":!1,offset:100},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.cardList,function(e,i){return a("div",{key:i,staticClass:"list-card"},[a("div",{staticClass:"card-left"},[a("div",{staticClass:"card-left-cell"},[a("div",{staticClass:"left-cell-title"},[t._v("装货地")]),t._v(" "),a("div",{staticClass:"maohao"},[t._v("：")]),t._v(" "),a("div",{staticClass:"left-cell-value blue"},[t._v("\n                  "+t._s(e.startAddress)+"\n                ")])]),t._v(" "),a("div",{staticClass:"card-left-cell"},[a("div",{staticClass:"left-cell-title"},[t._v("卸货地")]),t._v(" "),a("div",{staticClass:"maohao"},[t._v("：")]),t._v(" "),a("div",{staticClass:"left-cell-value blue"},[t._v(t._s(e.endAddress))])]),t._v(" "),a("div",{staticClass:"card-left-cell"},[a("div",{staticClass:"left-cell-title"},[t._v("车辆信息")]),t._v(" "),a("div",{staticClass:"maohao"},[t._v("：")]),t._v(" "),a("div",{staticClass:"left-cell-value black"},[t._v(t._s(e.carInfo))])]),t._v(" "),a("div",{staticClass:"card-left-cell"},[a("div",{staticClass:"left-cell-title"},[t._v("期望运费")]),t._v(" "),a("div",{staticClass:"maohao"},[t._v("：")]),t._v(" "),a("div",{staticClass:"left-cell-value black"},[t._v("\n                  "+t._s(e.expectFreight)+"\n                ")])])]),t._v(" "),a("div",{staticClass:"card-right"},[a("div",{staticClass:"btn",on:{click:function(a){return a.stopPropagation(),t.useBtnClick(e.transportTemplateId)}}},[t._v("\n                使用\n              ")])])])}),0)],1)],1)]),t._v(" "),a("van-action-sheet",{attrs:{actions:t.actions,"cancel-text":"取消"},on:{select:t.onSelect,cancel:function(e){t.cardShow=!1}},model:{value:t.cardShow,callback:function(e){t.cardShow=e},expression:"cardShow"}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"p1"},[e("span",{staticClass:"iconfont iconleijijingyingshouyijieshi"}),this._v(" "),e("i",{staticClass:"iconfont iconwenhao"}),this._v("什么是常用发货模板？\n      ")])}]};var C=a("C7Lr")(m,g,!1,function(t){a("dm0c")},"data-v-6dda24bc",null);e.default=C.exports},dm0c:function(t,e){}});