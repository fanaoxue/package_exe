webpackJsonp([75],{Gj2S:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("KS8L"),o=i("yFUi"),a=i("P9l9"),n=i("LU6j"),d={name:"commonTemplate",data:function(){return{cityList:Object(o.a)(city.data),bitian:i("jmUF"),value3:[],value4:[],goodsName:"",unitPrice:"",goodsAmount:"",goodsAmountType:{key:"0",value:"吨"},items2:[{key:"0",value:"吨"},{key:"1",value:"方"},{key:"2",value:"件"},{key:"3",value:"车"}],cityIdArr:[],types:"",isDisable:!0,mWaybillTemplateId:this.$route.query.mWaybillTemplateId}},watch:{cityIdArr:function(){0!=this.cityIdArr.length&&(this.types=localStorage.getItem("types"),0==this.types?(this.startProvinceCode=this.cityIdArr[0],this.startCityCode=this.cityIdArr[1],this.startCountyCode=this.cityIdArr[2],this.value3=[],this.value3=this.cityIdArr):(this.endCityCode=this.cityIdArr[1],this.endCountyCode=this.cityIdArr[2],this.value4=[],this.value4=this.cityIdArr)),window.localStorage.clear()}},beforeRouteEnter:function(t,e,i){"chooseCity"===e.name?i(function(t){t.$store.commit("updateLoadingStatus",{isLoading:!1}),t.cityIdArr=JSON.parse(localStorage.getItem("cityIdArr"))}):i()},created:function(){},mounted:function(){this.dataInit()},methods:{dataInit:function(){var t=this,e={mWaybillTemplateId:this.mWaybillTemplateId};Object(n.c)(e).then(function(e){if(t.$store.commit("updateLoadingStatus",{isLoading:!1}),0==e.data.reCode){var i=e.data.result;t.startCityCode=i.startCityId,t.startProvinceCode=i.startProvinceId,t.startCountyCode=i.startCountyId,t.endCityCode=i.endCityId,t.endProvinceCode=i.endProvinceId,t.endCountyCode=i.endCountyId,t.goodsName=i.goodsName,t.goodsAmount=i.goodsAmount,t.goodsAmountType.key=i.goodsAmountType,0==i.goodsAmountType?t.goodsAmountType.value="吨":1==i.goodsAmountType?t.goodsAmountType.value="方":2==i.goodsAmountType?t.goodsAmountType.value="件":t.goodsAmountType.value="车",t.unitPrice=i.unitPrice,t.value3.push(t.startProvinceCode,t.startCityCode,t.startCountyCode),t.value4.push(t.endProvinceCode,t.endCityCode,t.endCountyCode)}else t.$vux.toast.text(e.data.reInfo,"middle")}).catch(function(e){t.$store.commit("updateLoadingStatus",{isLoading:!1}),t.$vux.toast.text(e.message,"middle")})},chooseCity:function(t){var e=this;this.isDisable&&(this.isDisable=!1,this.$router.push({path:"/chooseCity",query:{type:t}})),setTimeout(function(){e.isDisable=!0},1e3)},startValue:function(){var t=this.value3;this.startProvinceCode=t[0],this.startCityCode=t[1],this.startCountyCode=t[2]},endValue:function(){var t=this.value4;this.endProvinceCode=t[0],this.endCityCode=t[1],this.endCountyCode=t[2]},saveTemplate:function(){var t=this,e=this.value3[1];if(this.isEmptyStr(e))return this.$vux.toast.text("始发城市必填！","middle"),!1;if(this.isEmptyStr(this.goodsName))return this.goodsName=this.trim(this.goodsName),this.$vux.toast.text("货物名称必填！","middle"),!1;if(!this.isEmptyStr(this.goodsAmount)){this.goodsAmount=this.trim(this.goodsAmount);if(!("0"==this.goodsAmountType.key?/^([1-9]\d{0,6}|0)([\.]\d{0,4})?$/:/^([1-9]\d{0,6}|0)([\.]\d{0,2})?$/).test(this.goodsAmount))return this.$vux.toast.text("无效的货物数量！","middle"),!1}if(this.isEmptyStr(this.goodsAmountType.key))return this.$vux.toast.text("请选择货物数量单位！","middle"),!1;if(!this.isEmptyStr(this.unitPrice)){this.unitPrice=this.trim(this.unitPrice);if(!/^([1-9]\d{0,6}|0)([\.]\d{0,4})?$/.test(this.unitPrice))return this.$vux.toast.text("无效的运输单价！","middle"),!1}var i=this.value3[0],s=this.value3[1],o=this.value4[1],n=this.value3[2],d=this.value4[2];this.$store.commit("updateLoadingStatus",{isLoading:!0}),this.isEmptyStr(i)||this.isEmptyStr(s)||this.isEmptyStr(o)?this.gotoSave():Object(a.d)(i,s,o,n,d).then(function(e){if(0!=e.data.reCode)return t.$store.commit("updateLoadingStatus",{isLoading:!1}),t.$vux.toast.text(e.data.reInfo,"middle"),!1;t.gotoSave()}).catch(function(e){t.$store.commit("updateLoadingStatus",{isLoading:!1}),t.$vux.toast.text(e.message,"middle")})},gotoSave:function(){var t=this,e={mWaybillTemplateId:this.mWaybillTemplateId,startProvinceId:this.value3[0],startCityId:this.value3[1],startCountyId:this.value3[2],endProvinceId:this.value4[0],endCityId:this.value4[1],endCountyId:this.value4[2],goodsName:this.goodsName,goodsAmountType:this.goodsAmountType.key,goodsAmount:this.goodsAmount,unitPrice:this.unitPrice,source:"2"};Object(n.a)(e).then(function(e){t.$store.commit("updateLoadingStatus",{isLoading:!1}),"0"===e.data.reCode?(t.$vux.toast.text(e.data.reInfo,"middle"),Object(s.e)({type:"2"}),setTimeout(function(){Object(s.a)(-1)},1e3)):t.$vux.toast.text(e.data.reInfo,"middle")}).catch(function(e){t.$store.commit("updateLoadingStatus",{isLoading:!1}),t.$vux.toast.text(e.message,"middle")})},trim:function(t){return t.toString().replace(/(^\s*)|(\s*$)/g,"")},isEmptyStr:function(t){return!(void 0!=t&&""!=t&&null!=t&&!/^[\s]*$/.test(t))}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-template"},[i("c-header",[i("x-header",{attrs:{"left-options":{backText:""}}},[t._v("修改常用模板")])],1),t._v(" "),i("group",{attrs:{"label-width":"6.5em","label-align":"right"}},[i("popup-picker",{attrs:{title:"始发城市：",data:t.cityList,columns:3,"show-name":"",placeholder:"请选择装货地",disabled:""},on:{"on-hide":t.startValue},nativeOn:{click:function(e){return t.chooseCity(0)}},scopedSlots:t._u([{key:"title",fn:function(e){return[i("span",{class:e.labelClass,staticStyle:{height:"24px"},style:e.labelStyle},[i("img",{staticClass:"img1",staticStyle:{"font-size":"20px","vertical-align":"middle"},attrs:{src:t.bitian,alt:"",width:"8",height:"8"}}),t._v(" "),i("span",{staticStyle:{"vertical-align":"middle"}},[t._v("始发城市：")])])]}}]),model:{value:t.value3,callback:function(e){t.value3=e},expression:"value3"}}),t._v(" "),i("popup-picker",{attrs:{title:"目的城市：",data:t.cityList,columns:3,"show-name":"",placeholder:"请选择卸货地",disabled:""},on:{"on-hide":t.endValue},nativeOn:{click:function(e){return t.chooseCity(1)}},model:{value:t.value4,callback:function(e){t.value4=e},expression:"value4"}}),t._v(" "),i("x-input",{attrs:{title:"货物名称：",placeholder:"请填写货物名称",type:"text"},model:{value:t.goodsName,callback:function(e){t.goodsName=e},expression:"goodsName"}},[i("div",{staticStyle:{"text-align":"right",width:"6.5em"},attrs:{slot:"label"},slot:"label"},[i("img",{staticClass:"img1",staticStyle:{"font-size":"20px","vertical-align":"middle"},attrs:{src:t.bitian,alt:"",width:"8",height:"8"}}),t._v(" "),i("span",{staticStyle:{"vertical-align":"middle"}},[t._v("货物名称：")])])]),t._v(" "),i("x-input",{attrs:{title:"货物数量：",placeholder:"请填写货物数量","show-clear":!1},model:{value:t.goodsAmount,callback:function(e){t.goodsAmount=e},expression:"goodsAmount"}},[i("div",{staticStyle:{"text-align":"right",width:"6.5em"},attrs:{slot:"label"},slot:"label"},[i("img",{staticClass:"img1",staticStyle:{"font-size":"20px","vertical-align":"middle"},attrs:{src:t.bitian,alt:"",width:"8",height:"8"}}),t._v(" "),i("span",{staticStyle:{"vertical-align":"middle"}},[t._v("货物数量：")])]),t._v(" "),i("div",{attrs:{slot:"right"},slot:"right"},[i("checker",{attrs:{"default-item-class":"demo2-item","selected-item-class":"demo2-item-selected","radio-required":""},model:{value:t.goodsAmountType,callback:function(e){t.goodsAmountType=e},expression:"goodsAmountType"}},t._l(t.items2,function(e,s){return i("checker-item",{key:s,attrs:{value:e}},[t._v(t._s(e.value))])}),1)],1)]),t._v(" "),i("x-input",{attrs:{title:"运输单价：",placeholder:"请输入货物的单价"},model:{value:t.unitPrice,callback:function(e){t.unitPrice=e},expression:"unitPrice"}})],1),t._v(" "),i("div",{staticStyle:{height:"56px"},attrs:{id:"footer"}}),t._v(" "),i("div",{staticClass:"button"},[i("x-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.saveTemplate(e)}}},[t._v("保存")])],1)],1)},staticRenderFns:[]};var r=i("C7Lr")(d,l,!1,function(t){i("zm+d")},null,null);e.default=r.exports},"zm+d":function(t,e){}});